# 踩坑合集





#### formAction是会阻塞UI的

比如用useRequest + formAction，那么你就看不到loading的效果，因为formAction理论上是在跳转页面，你当前的页面已经不存在了，所以看起来没效果



解决办法

1. 使用官方useActionState()
2. 不适用formAction



我选了第二种，因为更符合前端的操作







#### Link/Router跳转页面很慢

本地是几十毫秒，线上直接1s... 这个可以说卡出翔的感觉

想象中是单页的效果，硬整成了多页的效果

虽然单页也是会切割路由和资源，理论上加载也不快，但是相信我这个不快和慢的要死是两种不同的概念

Nextjs跳转真的慢

你以为是中间件问题，实际上也不是...&#x20;

你以为是网络问题，实际上也不算，因为老外也会遇到...&#x20;

那怎么解决？



1. 用加载进度条
2. 用prefetch



第二种理论上是默认开启的，不过没测试效果，网上也看到显性添加才有效果的案例，先不管。毕竟这个很麻烦... 还得思考哪些要加



第一种直接就是偷懒的做法...&#x20;









#### Next Image 加载巨慢

我在vercel，慢得跟屎一样... 变成了负优化 本来一张图如果是国内加载200ms，然后nextImage默认会对图片进行优化处理，它先下载图片，耗时1s，然后优化图片，耗时200ms，再返回图片，耗时1s...

如果你是国内图片国内服务器还好，如果源图片确实比较大，那优化是有效果，否则大概率还是蛮....

而且现在大部分项目都是使用第三方储存库... 都自带压缩，所以这个功能更加没用

然后解决办法

1. unoptimized设为true 意思就是不要优化了，纯当个img用
2. 使用自定义loader兼容第三方储存库的

第一个最粗暴但是最好用，你自己要优化就和以前一样加个判断函数，或者直接加后缀 第二个loader，想象是美好的，但是会遇到其他一些问题 比如不同像素比的屏幕生成宽度很坑爹... 比如不知道宽高用fill的时候，宽度基本就是最大的，移动端1200，pc端3840...
